# .ebextensions/python.config

container_commands:
  01_install_dependencies:
    command: |
      echo "Installing Python dependencies..."
      source /var/app/venv/*/bin/activate
      pip install --upgrade pip
      pip install -r requirements.txt --log /var/log/pip_install.log
      cat /var/log/pip_install.log

  02_collect_static:
    command: |
      echo "Collecting Django static files..."
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python manage.py collectstatic --noinput
    leader_only: true

  03_migrate:
    command: |
      echo "Applying Django database migrations..."
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python manage.py migrate --noinput
    leader_only: true
